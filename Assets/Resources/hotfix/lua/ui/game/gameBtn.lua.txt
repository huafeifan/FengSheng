GameBtn = {}
GameBtn.__index = GameBtn

function GameBtn:New(gameObject, main)
	local item = {}
	item.gameObject = gameObject
	item.transform = gameObject.transform
	item.ui = {}
	item.main = main

	setmetatable(item, GameBtn)
	return item
end

function GameBtn:InitUIReference()
	self.ui.startBtn = self.transform:Find("StartBtn"):GetComponent(typeof(Button))
	self.ui.exitBtn = self.transform:Find("ExitBtn"):GetComponent(typeof(Button))
	self.ui.readyBtn = self.transform:Find("ReadyBtn"):GetComponent(typeof(Button))
	self.ui.ruleBtn = self.transform:Find("RuleBtn"):GetComponent(typeof(Button))
end

function GameBtn:InitUI()
	self.ui.startBtn.gameObject:SetActive(false)
	self.ui.exitBtn.gameObject:SetActive(true)
	self.ui.readyBtn.gameObject:SetActive(false)
	self.ui.ruleBtn.gameObject:SetActive(true)
end

function GameBtn:RefreshRoomInfo()
	local myChair = self.main.chairList:GetMyChair()
	if myChair:IsOwner() == true then
		self.ui.startBtn.gameObject:SetActive(true)
		self.ui.readyBtn.gameObject:SetActive(false)
	else
		self.ui.startBtn.gameObject:SetActive(false)
		self.ui.readyBtn.gameObject:SetActive(myChair:IsReady() == false)
	end

end

function GameBtn:OnBtnStart()
	Global.Methods.PlayBtnAnimation(self.ui.startBtn)
	Global.Protos.Game.SendGameStart()
end

function GameBtn:OnBtnExit()
	Global.Methods.PlayBtnAnimation(self.ui.exitBtn)
	Global.Protos.Room.SendExitRoom()
end

function GameBtn:OnBtnReady()
	Global.Methods.PlayBtnAnimation(self.ui.readyBtn)
	local myChair = self.main.chairList:GetMyChair()
	if myChair:IsOwner() == false then
		Global.Protos.Room.SendReadyStatus(true)
	end
end

function GameBtn:OnBtnRule()
	Global.Methods.PlayBtnAnimation(self.ui.ruleBtn)
	UIManager:OpenUI(Global.RulePrefab_Path)
end

function GameBtn:AddUIEvent()
	UIEventManager:AddListener(self.ui.startBtn, self.OnBtnStart, self, "lua.game.gameBtn.OnBtnStart")
	UIEventManager:AddListener(self.ui.exitBtn, self.OnBtnExit, self, "lua.game.gameBtn.OnBtnExit")
	UIEventManager:AddListener(self.ui.readyBtn, self.OnBtnReady, self, "lua.game.gameBtn.OnBtnReady")
	UIEventManager:AddListener(self.ui.ruleBtn, self.OnBtnRule, self, "lua.game.gameBtn.OnBtnRule")
end

function GameBtn:RemoveUIEvent()
	UIEventManager:RemoveAllListeners(self.ui.startBtn)
	UIEventManager:RemoveAllListeners(self.ui.exitBtn)
	UIEventManager:RemoveAllListeners(self.ui.readyBtn)
	UIEventManager:RemoveAllListeners(self.ui.ruleBtn)
end

function GameBtn:OnGameStart()
	self.ui.startBtn.gameObject:SetActive(false)
	self.ui.readyBtn.gameObject:SetActive(false)
end

function GameBtn:AddListener()
	EventManager:AddListener(Global.Event.GameStage.GameStart, function() self:OnGameStart() end, "Lua.game.gameBtn.OnGameStart")
end

function GameBtn:RemoveListener()
	EventManager:RemoveListener(Global.Event.GameStage.GameStart, "Lua.game.gameBtn.OnGameStart")
end

function GameBtn:Dispose()
	UIManager:CloseUI(Global.RulePrefab_Path)
end